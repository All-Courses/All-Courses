<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Courses</title>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700;900&display=swap" rel="stylesheet">
</head>
<body style="margin:0; padding:20px; font-family:'Poppins',sans-serif; background:#fafafa;">

<!-- TOP BAR / HERO -->
<div style="font-family: 'Poppins', sans-serif; text-align: center; background: linear-gradient(90deg, #fffef9, #f4faff, #fff7f5, #f3fff8); background-size: 300% 300%; padding: 28px 15px; border-radius: 12px; overflow: hidden; position: relative; animation: bgShift 10s ease infinite; width: 90%; max-width: 900px; margin: 0 auto;">

  <!-- INLINE STYLES (your original ones, plus disclaimer-btn + a couple of utilities) -->
  <style>
    /* Moving gradient background */
    @keyframes bgShift {
      0% {background-position: 0% 50%;}
      50% {background-position: 100% 50%;}
      100% {background-position: 0% 50%;}
    }

    /* Floating motion for doodles */
    @keyframes float {
      0% {transform: translateY(0);}
      50% {transform: translateY(-8px);}
      100% {transform: translateY(0);}
    }

    /* Small book animation */
    @keyframes floatBook {
      0% {transform: translateY(0) scale(0.8);}
      50% {transform: translateY(-6px) scale(1);}
      100% {transform: translateY(0) scale(0.8);}
    }

    /* Transparent cartoon book */
    .book-icon {
      font-size: 2em;
      opacity: 0.25;
      animation: floatBook 3s ease-in-out infinite;
      pointer-events: none;
    }

    /* Doodles */
    .doodle {
      position: absolute;
      opacity: 0.15;
      font-size: 1.8em;
      animation: float 6s ease-in-out infinite;
      pointer-events: none;
      z-index: 1;
    }

    /* Title text */
    .title {
      font-size: 3.8em;
      font-weight: 900;
      letter-spacing: 7px;
      color: #555;
      text-shadow: none;
      display: inline-block;
      vertical-align: middle;
      z-index: 2;
    }

    /* Responsive scaling */
    @media (max-width: 600px) {
      .title { font-size: 2.8em; letter-spacing: 4px; }
      .doodle { font-size: 1.3em; }
      .book-icon { font-size: 1.5em; }
    }

    /* DISCLAIMER button (top-right of this bar, does NOT change bar height) */
    .disclaimer-btn {
      position: absolute;
      top: 10px;
      right: 10px;
      z-index: 10;
      background: rgba(0,0,0,0.05);
      color: #333;
      border: 1px solid rgba(0,0,0,0.08);
      padding: 5px 10px;
      border-radius: 12px;
      font-size: 13px;
      cursor: pointer;
      backdrop-filter: blur(2px);
    }
    .disclaimer-btn:hover {
      filter: brightness(0.95);
      transform: translateY(-1px);
    }
  </style>

  <!-- Doodles -->
  <span class="doodle" style="top:15%; left:15%; animation-delay:0s;">‚úèÔ∏è</span>
  <span class="doodle" style="bottom:20%; right:25%; animation-delay:1s;">üìö</span>
  <span class="doodle" style="top:45%; left:40%; animation-delay:2s;">üéì</span>
  <span class="doodle" style="bottom:15%; left:25%; animation-delay:3s;">üìê</span>

  <!-- Disclaimer button (top-right, small) -->
  <button class="disclaimer-btn" onclick="toggleDisclaimer()">Disclaimer</button>

  <!-- Title with animated small books on sides -->
  <div style="display: flex; justify-content: center; align-items: center; flex-wrap: nowrap; white-space: nowrap; position: relative; z-index: 2; gap: 15px;">
    <span class="book-icon" style="animation-delay: 0s;">üìñ</span>
    <span class="title">COURSES</span>
    <span class="book-icon" style="animation-delay: 0.5s;">üìñ</span>
  </div>
</div>

<!-- POPUP: DISCLAIMER -->
<div class="popup" id="disclaimerPopup">
  <span class="close" onclick="closePopup()">√ó</span>
  <ul>
    <li style="text-align:center; font-size:16px; font-weight:bold; color:#007bff;">Disclaimer</li>
    <li style="font-weight:500; font-size:14px;">This list is for guidance only and may not be exhaustive.</li>
    <li style="font-weight:500; font-size:14px;">Please verify all details directly with the institutions.</li>
  </ul>
</div>

<!-- ==================== RAS / PSI ==================== -->
<div class="R">
  <div class="B" style="--btn-bg:#ff6b6b;" onclick="togglePopup(this, 'raspPopup')">RAS</div>
  <div class="B" style="--btn-bg:#ff6b6b;" onclick="togglePopup(this, 'psiPopup')">PSI</div>
</div>

<div class="popup" id="raspPopup">
  <span class="close" onclick="closePopup()">√ó</span>
  <ul>
    <li style="text-align:center; font-size:18px; font-weight:bold; color:#007bff;">RAS</li>
    <li>Utkarsh Classes</li>
    <li>Lucent Academy</li>
    <li>StudyIQ</li>
  </ul>
</div>

<div class="popup" id="psiPopup">
  <span class="close" onclick="closePopup()">√ó</span>
  <ul>
    <li style="text-align:center; font-size:18px; font-weight:bold; color:#007bff;">PSI</li>
    <li>Utkarsh Classes</li>
    <li>Lucent Academy</li>
    <li>StudyIQ</li>
  </ul>
</div>

<style>
.R {
  display: flex;
  gap: 20px; /* space between buttons */
  justify-content: center;
  margin-top: 15px;
}

/* Button Styles */
.B {
  position: relative;
  display: inline-block;
  padding: 13px 45px;
  background: #ff6b6b; /* light red */
  color: white;
  font-weight: bold;
  text-decoration: none;
  border-radius: 25px; /* round corners */
  overflow: hidden;
  box-shadow: 0 5px 15px rgba(0,0,0,0.2);
  animation: bobbing 2s infinite alternate;
  cursor: pointer;
}

/* Shine effect */
.B::before {
  content: '';
  position: absolute;
  top: 0;
  left: -75%;
  width: 50%;
  height: 110%;
  background: linear-gradient(
    120deg, 
    rgba(255,255,255,0) 0%, 
    rgba(255,255,255,0.4) 50%, 
    rgba(255,255,255,0) 100%
  );
  transform: skewX(-25deg);
  animation: shine 2s infinite;
}

/* Bobbing animation */
@keyframes bobbing {
  0% { transform: translateY(0); }
  50% { transform: translateY(-5px); }
  100% { transform: translateY(0); }
}

/* Shine animation */
@keyframes shine {
  0% { left: -75%; }
  100% { left: 125%; }
}

.B:hover {
  transform: scale(1.1); /* slight grow on hover */
}

/* ACTIVE STATE (used by JS when any popup button is clicked) */
.active-btn {
  filter: brightness(0.75);   /* Darken the button */
  transform: scale(1.05);     /* Optional slight scaling */
}  

.popup {
  position: fixed;
  background: rgba(255, 255, 255, 0.6);
  backdrop-filter: blur(6px);
  border-radius: 16px;
  box-shadow: 0 8px 25px rgba(0,0,0,0.25);
  padding: 20px 25px 15px 25px;
  width: auto;
  min-width: 160px;
  max-width: 80%;
  text-align: left;
  opacity: 0;
  transform: scale(0.7);
  transition: all 0.35s ease;
  z-index: 9999;
  pointer-events: none;
}

.popup.active {
  opacity: 1;
  transform: scale(1) translateY(0);
  pointer-events: auto;
}

.popup ul {
  list-style: none;
  padding: 0;
  margin: 0;
}
  
.popup li {
  font-size: 16px;
  color: #000;
  font-weight: bold;
  margin: 8px 0;
  opacity: 1;
  white-space: nowrap;
}

.popup-heading {
  font-size: 18px;          
  font-weight: 700;          
  color: #333;               
  margin-bottom: 12px;       
  line-height: 1.4;          
  text-align: left;          
}
  
.close {
  position: absolute;
  top: 8px;
  right: 10px;
  font-size: 20px;
  color: gray;
  cursor: pointer;
  user-select: none;
}

@keyframes fadeOut {
  from { opacity: 1; transform: scale(1); }
  to { opacity: 0; transform: scale(0.7); }
}
</style>

<!-- ==================== 1st / 2nd / 3rd Grade ==================== -->
<div class="button-row-blue">
  <a href="firstgrade.html" class="fancy-button-blue">1st Grade</a>
  <a href="secondgrade.html" class="fancy-button-blue">2nd Grade</a>
  <a href="reet.html" class="fancy-button-blue">3rd Grade</a>
</div>

<style>
.button-row-blue {
  display: flex;
  gap: 10px; /* space between buttons */
  justify-content: center;
  flex-wrap: wrap; /* allows wrapping on very small screens */
  margin-top: 25px;
}

/* Button Styles */
.fancy-button-blue {
  position: relative;
  display: inline-block;
  padding: 10px 18px; /* smaller padding for short width */
  min-width: 70px; /* ensures they are short and fit on mobile */
  text-align: center;
  background: #4fc3f7; /* light blue */
  color: white;
  font-weight: bold;
  text-decoration: none;
  border-radius: 25px; /* round corners */
  overflow: hidden;
  box-shadow: 0 4px 10px rgba(0,0,0,0.2);
  animation: bobbing 2s infinite alternate;
  font-size: 14px; /* smaller text for mobile */
}

/* Shine effect */
.fancy-button-blue::before {
  content: '';
  position: absolute;
  top: 0;
  left: -75%;
  width: 50%;
  height: 100%;
  background: linear-gradient(
    120deg, 
    rgba(255,255,255,0) 0%, 
    rgba(255,255,255,0.5) 50%, 
    rgba(255,255,255,0) 100%
  );
  transform: skewX(-25deg);
  animation: shine 2s infinite;
}

/* Bobbing animation */
@keyframes bobbing {
  0% { transform: translateY(0); }
  50% { transform: translateY(-5px); }
  100% { transform: translateY(0); }
}

/* Shine animation */
@keyframes shine {
  0% { left: -75%; }
  100% { left: 125%; }
}

.fancy-button-blue:hover {
  transform: scale(1.1);
}
</style>

<!-- ==================== Asst Prof / NET JRF ==================== -->
<div class="button-row-green">
  <a href="assprof.html" class="fancy-button-green">Asst Prof</a>
  <a href="netjrf.html" class="fancy-button-green">NET JRF</a>
</div>

<style>
.button-row-green {
  display: flex;
  gap: 20px; /* space between buttons */
  justify-content: center;
  flex-wrap: wrap; /* ensures it fits on small screens */
  margin-top: 22px;
}

/* Button Styles */
.fancy-button-green {
  position: relative;
  display: inline-block;
  padding: 10px 18px; /* short width */
  min-width: 90px;
  text-align: center;
  background: #b9fbc0; /* very light green */
  color: #333;
  font-weight: bold;
  text-decoration: none;
  border-radius: 25px; /* round corners */
  overflow: hidden;
  box-shadow: 0 4px 10px rgba(0,0,0,0.2);
  animation: bobbing 2s infinite alternate;
  font-size: 14px;
}

/* Shine effect */
.fancy-button-green::before {
  content: '';
  position: absolute;
  top: 0;
  left: -75%;
  width: 50%;
  height: 100%;
  background: linear-gradient(
    120deg, 
    rgba(255,255,255,0) 0%, 
    rgba(255,255,255,0.5) 50%, 
    rgba(255,255,255,0) 100%
  );
  transform: skewX(-25deg);
  animation: shine 2s infinite;
}

/* Bobbing animation */
@keyframes bobbing {
  0% { transform: translateY(0); }
  50% { transform: translateY(-5px); }
  100% { transform: translateY(0); }
}

/* Shine animation */
@keyframes shine {
  0% { left: -75%; }
  100% { left: 125%; }
}

.fancy-button-green:hover {
  transform: scale(1.1);
}
</style>

<!-- ==================== Rajasthan All Exams ==================== -->
<div class="button-row-special">
  <a href="rajall.html" class="fancy-button-special">Rajasthan All Exams</a>
</div>

<style>
.button-row-special {
  display: flex;
  justify-content: center;
  margin-top: 25px;
}

/* Special Button Style */
.fancy-button-special {
  position: relative;
  display: inline-block;
  padding: 10px 22px; /* short width */
  min-width: 200px;
  text-align: center;
  background: #d3d3d3; /* very light gray */
  border: 1.5px solid #9e9e9e; /* normal/darker gray outline */
  color: #333; /* darker gray font */
  font-weight: bold;
  text-decoration: none;
  border-radius: 15px; /* rounded corners */
  overflow: hidden;
  box-shadow: 0 3px 10px rgba(0,0,0,0.15);
  font-size: 16px;
  animation: pulseMove 3s infinite ease-in-out;
  transition: transform 0.3s ease;
}

/* Enhanced Shine Effect */
.fancy-button-special::before {
  content: '';
  position: absolute;
  top: 0;
  left: -100%;
  width: 50%;
  height: 100%;
  background: linear-gradient(
    120deg,
    rgba(255,255,255,0) 0%,
    rgba(255,255,255,0.7) 50%,
    rgba(255,255,255,0) 100%
  );
  transform: skewX(-20deg);
  animation: smoothShine 2.5s infinite ease-in-out;
}

/* Unique smooth shine animation (slower and softer) */
@keyframes smoothShine {
  0% { left: -100%; opacity: 0.3; }
  50% { left: 120%; opacity: 0.8; }
  100% { left: -100%; opacity: 0.3; }
}

/* Pulse + slight floating motion */
@keyframes pulseMove {
  0% { transform: scale(1) translateY(0); }
  25% { transform: scale(1.05) translateY(-3px); }
  50% { transform: scale(1) translateY(0); }
  75% { transform: scale(1.05) translateY(3px); }
  100% { transform: scale(1) translateY(0); }
}

.fancy-button-special:hover {
  transform: scale(1.08);
}
</style>

<!-- ==================== UPSC / SSC ==================== -->
<div class="button-row-purple">
  <a href="upsc.html" class="fancy-button-purple">UPSC</a>
  <a href="ssc.html" class="fancy-button-purple">SSC</a>
</div>

<style>
.button-row-purple {
  display: flex;
  gap: 15px; /* space between buttons */
  justify-content: center;
  flex-wrap: wrap; /* ensures it fits on small screens */
  margin-top: 23px;
}

/* Button Styles */
.fancy-button-purple {
  position: relative;
  display: inline-block;
  padding: 10px 18px; /* short width */
  min-width: 90px;
  text-align: center;
  background: #cba3f7; /* light purple */
  color: #fff;
  font-weight: bold;
  text-decoration: none;
  border-radius: 25px; /* round corners */
  overflow: hidden;
  box-shadow: 0 4px 10px rgba(0,0,0,0.2);
  animation: bobbing 2s infinite alternate;
  font-size: 15px;
}

/* Shine effect */
.fancy-button-purple::before {
  content: '';
  position: absolute;
  top: 0;
  left: -75%;
  width: 50%;
  height: 100%;
  background: linear-gradient(
    120deg, 
    rgba(255,255,255,0) 0%, 
    rgba(255,255,255,0.5) 50%, 
    rgba(255,255,255,0) 100%
  );
  transform: skewX(-25deg);
  animation: shine 2s infinite;
}

/* Bobbing animation */
@keyframes bobbing {
  0% { transform: translateY(0); }
  50% { transform: translateY(-5px); }
  100% { transform: translateY(0); }
}

/* Shine animation */
@keyframes shine {
  0% { left: -75%; }
  100% { left: 125%; }
}

.fancy-button-purple:hover {
  transform: scale(1.1);
}
</style>

<!-- ==================== IIT JEE / NEET (POPUPS) ==================== -->
<div class="R5">
  <div class="B5" style="--btn-bg:#fff89a;" onclick="togglePopup(this, 'iitPopup')">IIT JEE</div>
  <div class="B5" style="--btn-bg:#fff89a;" onclick="togglePopup(this, 'neetPopup')">NEET</div>
</div>

<div class="popup" id="iitPopup">
  <span class="close" onclick="closePopup()">√ó</span>
  <ul>
    <li style="text-align:center; font-size:18px; font-weight:bold; color:#007bff;">IIT JEE</li>
    <li>Utkarsh Classes</li>
    <li>Lucent Academy</li>
    <li>StudyIQ</li>
  </ul>
</div>

<div class="popup" id="neetPopup">
  <span class="close" onclick="closePopup()">√ó</span>
  <ul>
    <li style="text-align:center; font-size:18px; font-weight:bold; color:#007bff;">NEET</li>
    <li>Utkarsh Classes</li>
    <li>Lucent Academy</li>
    <li>StudyIQ</li>
  </ul>
</div>

<style>
.R5 {
  display: flex;
  gap: 13px; /* space between buttons */
  justify-content: center;
  flex-wrap: wrap; /* ensures it fits on small screens */
  margin-top: 21px;
}

/* Button Styles */
.B5 {
  position: relative;
  display: inline-block;
  padding: 10px 18px; /* short width */
  min-width: 90px;
  text-align: center;
  background: #fff89a; /* light yellow */
  color: #7F7F7F; /* black font */
  font-weight: bold;
  text-decoration: none;
  border-radius: 25px; /* round corners */
  overflow: hidden;
  box-shadow: 0 4px 10px rgba(0,0,0,0.2);
  animation: bobbing 2s infinite alternate;
  font-size: 15px;
  cursor: pointer;
}

/* Shine effect */
.B5::before {
  content: '';
  position: absolute;
  top: 0;
  left: -75%;
  width: 50%;
  height: 100%;
  background: linear-gradient(
    120deg, 
    rgba(255,255,255,0) 0%, 
    rgba(255,255,255,0.5) 50%, 
    rgba(255,255,255,0) 100%
  );
  transform: skewX(-25deg);
  animation: shine 2s infinite;
}

/* Bobbing animation */
@keyframes bobbing {
  0% { transform: translateY(0); }
  50% { transform: translateY(-5px); }
  100% { transform: translateY(0); }
}

/* Shine animation */
@keyframes shine {
  0% { left: -75%; }
  100% { left: 125%; }
}

.B5:hover {
  transform: scale(1.1);
}
</style>

<!-- ==================== NURSING / BANKING / DEFENCE / RAILWAY (POPUPS) ==================== -->
<div class="Rx4">
<div class="R1">
  <div class="B1" style="--btn-bg:#e6f7ff;" onclick="togglePopup(this, 'nursingPopup')">NURSING</div>
  <div class="B1" style="--btn-bg:#e6f7ff;" onclick="togglePopup(this, 'bankPopup')">BANKING</div>
</div>
<div class="R1">
  <div class="B1" style="--btn-bg:#e6f7ff;" onclick="togglePopup(this, 'defencePopup')">DEFECE</div>
  <div class="B1" style="--btn-bg:#e6f7ff;" onclick="togglePopup(this, 'railwayPopup')">RAILWAY</div>
</div>
</div>

<div class="popup" id="nursingPopup">
  <span class="close" onclick="closePopup()">√ó</span>
  <ul>
    <li style="text-align:center; font-size:18px; font-weight:bold; color:#007bff;">NURSING</li>
    <li>Utkarsh Classes</li>
    <li>Lucent Academy</li>
    <li>StudyIQ</li>
  </ul>
</div>

<div class="popup" id="bankPopup">
  <span class="close" onclick="closePopup()">√ó</span>
  <ul>
    <li style="text-align:center; font-size:18px; font-weight:bold; color:#007bff;">BANKING</li>
    <li>Utkarsh Classes</li>
    <li>Lucent Academy</li>
    <li>StudyIQ</li>
  </ul>
</div>

<div class="popup" id="defencePopup">
  <span class="close" onclick="closePopup()">√ó</span>
  <ul>
    <li style="text-align:center; font-size:18px; font-weight:bold; color:#007bff;">DEFENCE</li>
    <li>Utkarsh Classes</li>
    <li>Lucent Academy</li>
    <li>StudyIQ</li>
  </ul>
</div>

<div class="popup" id="railwayPopup">
  <span class="close" onclick="closePopup()">√ó</span>
  <ul>
    <li style="text-align:center; font-size:18px; font-weight:bold; color:#007bff;">RAILWAY</li>
    <li>Utkarsh Classes</li>
    <li>Lucent Academy</li>
    <li>StudyIQ</li>
  </ul>
</div>

<style>
.Rx4 {
  display: flex;
  flex-direction: column;
  gap: 20px; /* gap between upper and lower row */
  align-items: center;
  margin-top: 30px;
}

.R1 {
  display: flex;
  gap: 15px; /* space between buttons */
  justify-content: center;
  flex-wrap: wrap; /* wrap on very small screens */
}

/* Button Styles */
.B1 {
  position: relative;
  display: inline-block;
  padding: 10px 18px; /* short width */
  min-width: 110px;
  text-align: center;
  background: #e6f7ff; /* very very light blue */
  border: 1px solid #b3e0ff; /* thin light blue outline */
  color: #000; /* black font */
  font-weight: bold;
  text-decoration: none;
  border-radius: 19px; /* round corners */
  overflow: hidden;
  box-shadow: 0 3px 8px rgba(0,0,0,0.1);
  animation: bobbing 2s infinite alternate;
  font-size: 15px;
  cursor: pointer;
}

/* Shine effect */
.B1::before {
  content: '';
  position: absolute;
  top: 0;
  left: -75%;
  width: 50%;
  height: 100%;
  background: linear-gradient(
    120deg,
    rgba(255,255,255,0) 0%,
    rgba(255,255,255,0.5) 50%,
    rgba(255,255,255,0) 100%
  );
  transform: skewX(-25deg);
  animation: shine 2s infinite;
}

/* Bobbing animation */
@keyframes bobbing {
  0% { transform: translateY(0); }
  50% { transform: translateY(-3px); }
  100% { transform: translateY(0); }
}

/* Shine animation */
@keyframes shine {
  0% { left: -75%; }
  100% { left: 125%; }
}

.B1:hover {
  transform: scale(1.05);
}
</style>

<!-- ==================== GATE / AE JE (POPUPS) ==================== -->
<div class="R3">
  <div class="B3" style="--btn-bg:#ffe5b4;" onclick="togglePopup(this, 'gatePopup')">GATE</div>
  <div class="B3" style="--btn-bg:#ffe5b4;" onclick="togglePopup(this, 'aejePopup')">AE JE</div>
</div>

<div class="popup" id="gatePopup">
  <span class="close" onclick="closePopup()">√ó</span>
  <ul>
    <li style="text-align:center; font-size:18px; font-weight:bold; color:#007bff;">GATE</li>
    <li>Utkarsh Classes</li>
    <li>Lucent Academy</li>
    <li>StudyIQ</li>
  </ul>
</div>

<div class="popup" id="aejePopup">
  <span class="close" onclick="closePopup()">√ó</span>
  <ul>
    <li style="text-align:center; font-size:18px; font-weight:bold; color:#007bff;">AE JE</li>
    <li>Utkarsh Classes</li>
    <li>Lucent Academy</li>
    <li>StudyIQ</li>
  </ul>
</div>

<style>
.R3 {
  display: flex;
  gap: 15px; /* space between buttons */
  justify-content: center;
  flex-wrap: wrap; /* ensures it fits on small screens */
  margin-top: 21px;
}

/* Button Styles */
.B3 {
  position: relative;
  display: inline-block;
  padding: 10px 18px; /* short width */
  min-width: 90px;
  text-align: center;
  background: #ffe5b4; /* light peach */
  color: #000; /* black font */
  font-weight: bold;
  text-decoration: none;
  border-radius: 25px; /* round corners */
  overflow: hidden;
  box-shadow: 0 4px 10px rgba(0,0,0,0.2);
  animation: bobbing 2s infinite alternate;
  font-size: 15px;
  cursor: pointer;
}

/* Shine effect */
.B3::before {
  content: '';
  position: absolute;
  top: 0;
  left: -75%;
  width: 50%;
  height: 100%;
  background: linear-gradient(
    120deg,
    rgba(255,255,255,0) 0%,
    rgba(255,255,255,0.5) 50%,
    rgba(255,255,255,0) 100%
  );
  transform: skewX(-25deg);
  animation: shine 2s infinite;
}

/* Bobbing animation */
@keyframes bobbing {
  0% { transform: translateY(0); }
  50% { transform: translateY(-5px); }
  100% { transform: translateY(0); }
}

/* Shine animation */
@keyframes shine {
  0% { left: -75%; }
  100% { left: 125%; }
}

.B3:hover {
  transform: scale(1.1);
}
</style>

<!-- ==================== JS ‚Äì POPUP + ACTIVE BUTTON LOGIC ==================== -->
<script>
  // Track the currently open popup and active button
  let currentPopupId = null;
  let currentActiveButton = null;

  // Position popup near the button
  function positionPopupNearButton(popupEl, buttonEl) {
    if (!popupEl || !buttonEl) return;

    const btnRect = buttonEl.getBoundingClientRect();
    const popupRect = popupEl.getBoundingClientRect();
    const spacing = 8;

    let top = window.scrollY + btnRect.bottom + spacing;
    let left = window.scrollX + btnRect.left;

    const maxLeft = window.innerWidth - popupRect.width - 12;
    if (left > maxLeft) left = Math.max(12, maxLeft);

    if (btnRect.bottom + popupRect.height + spacing > window.innerHeight) {
      top = window.scrollY + btnRect.top - popupRect.height - spacing;
    }

    popupEl.style.left = left + "px";
    popupEl.style.top = top + "px";
  }

  function togglePopup(buttonEl, popupId) {
    const popupEl = document.getElementById(popupId);
    if (!popupEl) return;

    // If clicking same popup, just close
    if (currentPopupId === popupId) {
      closePopup();
      return;
    }

    // Close any already open popup
    closePopup();

    // Open new popup
    popupEl.classList.add("active");
    positionPopupNearButton(popupEl, buttonEl);

    // Mark button as active (darken)
    if (buttonEl) {
      buttonEl.classList.add("active-btn");
      currentActiveButton = buttonEl;
    }

    currentPopupId = popupId;
  }

  function closePopup() {
    if (currentPopupId) {
      const prev = document.getElementById(currentPopupId);
      if (prev) prev.classList.remove("active");
      currentPopupId = null;
    }
    if (currentActiveButton) {
      currentActiveButton.classList.remove("active-btn");
      currentActiveButton = null;
    }
  }

  // Special for Disclaimer (opens fixed in top-right, no active button)
  function toggleDisclaimer() {
    const popup = document.getElementById("disclaimerPopup");
    if (!popup) return;

    if (popup.classList.contains("active")) {
      popup.classList.remove("active");
      currentPopupId = null;
      return;
    }
    // Close others
    closePopup();
    popup.classList.add("active");
    currentPopupId = "disclaimerPopup";

    // Position top-right of viewport
    popup.style.top = "65px";
    popup.style.right = "15px";
    popup.style.left = "auto";
  }

  // Close popup when clicking outside
  document.addEventListener("click", function (e) {
    const insidePopup = e.target.closest(".popup");
    const isPopupButton = e.target.closest(".B, .B1, .B3, .B5");
    const isDisclaimerBtn = e.target.closest(".disclaimer-btn");

    if (!insidePopup && !isPopupButton && !isDisclaimerBtn) {
      closePopup();
      const disclaimer = document.getElementById("disclaimerPopup");
      if (disclaimer) disclaimer.classList.remove("active");
    }
  });

  // Close on ESC
  document.addEventListener("keydown", function (e) {
    if (e.key === "Escape") {
      const disclaimer = document.getElementById("disclaimerPopup");
      if (disclaimer) disclaimer.classList.remove("active");
      closePopup();
    }
  });

  // Keep popup positioned on resize
  window.addEventListener("resize", function () {
    if (currentPopupId && currentActiveButton && currentPopupId !== "disclaimerPopup") {
      const popupEl = document.getElementById(currentPopupId);
      if (popupEl) positionPopupNearButton(popupEl, currentActiveButton);
    }
  });
</script>

</body>
</html>
